---
title: Data Visualisation
author: 'Ben Whalley'
# date: "September 2020"
# bibliography: [references.bib]
# biblio-style: apa6
link-citations: yes
output:
  webex::html_clean
---


```{r, include=F, echo=F, message=F}
source('_first_chunk.R')
```






![Nothing new under the sun: Mediaeval line plot, circa 1010. Image: [wikimedia](https://commons.wikimedia.org/wiki/File:Clm_14436_ecliptic_diagram.png)](images/Clm_14436_ecliptic_diagram.png)

----------------





```{r}

bmi %>% 
  filter(eq5d<1) %>% 
  ggplot(aes(bmi, eq5d)) + geom_smooth(method=lm) + 
  # geom_point(alpha=.05, position=position_jitter()) +
   facet_grid(~cut(age,8))

```




# Comparing categories

In the examples above we have been plotting continuous variables (and adding colours etc). We've
used density, scatter and smoothed line plots to do this.

Another common requirement is to use plots to compare summary statistics for different groups or
categories. For example, the classic plot in a psychology study looks like this:

```{r, echo=F, width=6, height=3}
set.seed(1234)
expdata <- expand.grid(Condition=LETTERS[1:3], stimuli=1:4, p=1:20) %>%
  mutate(RT = -200+rnorm(n(), 25 + 5*as.numeric(Condition=="A") + -4*as.numeric(stimuli==1), 6)^2, stimuli=factor(stimuli, labels=paste0("S", 1:4)))
write_csv(expdata, 'data/expdata.csv')
expdata <- read_csv('data/expdata.csv')
expdata %>%
  ggplot(aes(Condition, RT)) +
  stat_summary(geom='bar', fun.data=mean_se) +
  stat_summary(geom="errorbar", width=.2, fun.data=mean_se) + facet_wrap(~paste("Stimuli", stimuli))

```

However, there is evidence that readers often misinterpret bar plots. Specifically, the problem is
that we perceive values _within_ the bar area as more _likely_ than those just above, even though
this is not in fact the case.

A better choice is (almost always) to use a boxplot:

```{r}
expdata  %>%
  ggplot(aes(x=stimuli, y=RT)) + geom_boxplot()
```

**Explanation**: We used `Condition`, a category, as our x axis, and reaction times as the y axis.
We added `geom_boxplot` to show a boxplot.

:::{.tip}

If you're not familiar with boxplots, there are more details in the help files (type `?geom_boxplot`
into the console) or use the [wikipedia page here](https://en.wikipedia.org/wiki/Box_plot)

:::

:::{.exercise}

Load the (simulated) dataset called `expdata.csv`.

Either download the file and upload to your Rstudio project directory, or read it directly from this url: <https://gist.githubusercontent.com/benwhalley/f94baf447612e2434b181739dbba27df/raw/43df26022fff68f49918c795f27d7352dc0d3425/expdata.csv>

-   Recreate the boxplot above
-   Use a facet to recreate the plot you saw above, combining both `Condition` and `Stimuli`

:::


## Other data summary layers

If you _really_ need to plot the mean and standard error of different categories, ggplot has the
`stat_summary` command:

```{r}
expdata %>%
  ggplot(aes(Condition, RT)) + stat_summary()
```

**Explanation**: We used `Condition` and `RT` as our x and y axes, as before. This time we added
`stat_summary()` instead of `geom_boxplot()`. By default this plots the mean and standard error (a
measure of variability) in each group, using a **point-range plot**. This is better than a bar chart
because it avoids a known bias in how we read them. You can ignore the warning about
`No summary function supplied, defaulting to mean_se()` for now.

:::{.exercise}

As an extension exercise:

-   Adapt your facetted boxplot from above to show the mean and standard error instead
-   Can you combine both boxplot and summary in a single plot?

:::






------------

All content on this site is distributed under a [Creative Commons](https://creativecommons.org/)
licence. CC-BY-SA 4.0.
